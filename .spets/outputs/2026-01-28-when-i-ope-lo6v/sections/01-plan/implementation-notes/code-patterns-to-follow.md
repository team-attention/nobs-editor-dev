### Code Patterns to Follow
- Keep existing `unsafe` block structure
- Maintain `msg_send!` macro usage pattern
- Preserve the `#[cfg(target_os = "macos")]` conditional compilation
